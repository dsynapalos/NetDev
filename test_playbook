---
- hosts: CSR1000V
  become: yes
  become_method: enable
  connection: network_cli

  vars:
    - become_pass: "{{ CSR1000V_PASS }}"
    - ansible_user: "{{ CSR1000V_USER }}"
    - ansible_password: "{{ CSR1000V_PASS }}"
    - ansible_network_os: ios
    - ansible_ssh_port: "{{ CSR1000V_SSH }}"
  
  tasks:

    - name: run multiple commands on remote nodes
      ios_command:
        commands:
          - show runn
      register: config
        
    - debug: var=config.stdout_lines
    
    - name: configurable backup path
      ios_config:
        backup: yes
        backup_options:
          filename: tempfile
          dir_path: /
      
    #- copy: content="{{ config.stdout_lines }}" dest=tempfile
    #- name: Validate the sudoers file before saving
    #  lineinfile:
    #    path: tempfile
    #    state: present
    #    line: "{{ item }}"
    #    create: yes
    #  with_items:
    #    "{{config.stdout_lines[0]}}"